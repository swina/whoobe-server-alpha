(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["nuxpresso_76","nuxpresso_62","nuxpresso_68","nuxpresso_70"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"1e25":function(t,e,i){"use strict";var s=i("23e7"),r=i("58a8").end,n=i("c8d2"),o=n("trimEnd"),a=o?function(){return r(this)}:"".trimEnd;s({target:"String",proto:!0,forced:o},{trimEnd:a,trimRight:a})},"4d63":function(t,e,i){var s=i("83ab"),r=i("da84"),n=i("94ca"),o=i("7156"),a=i("9bf2").f,c=i("241c").f,l=i("44e7"),p=i("ad6d"),u=i("9f7f"),d=i("6eeb"),f=i("d039"),m=i("69f3").enforce,h=i("2626"),g=i("b622"),v=g("match"),_=r.RegExp,x=_.prototype,y=/a/g,b=/a/g,k=new _(y)!==y,E=u.UNSUPPORTED_Y,w=s&&n("RegExp",!k||E||f((function(){return b[v]=!1,_(y)!=y||_(b)==b||"/a/i"!=_(y,"i")})));if(w){var C=function(t,e){var i,s=this instanceof C,r=l(t),n=void 0===e;if(!s&&r&&t.constructor===C&&n)return t;k?r&&!n&&(t=t.source):t instanceof C&&(n&&(e=p.call(t)),t=t.source),E&&(i=!!e&&e.indexOf("y")>-1,i&&(e=e.replace(/y/g,"")));var a=o(k?new _(t,e):_(t,e),s?this:x,C);if(E&&i){var c=m(a);c.sticky=!0}return a},j=function(t){t in C||a(C,t,{configurable:!0,get:function(){return _[t]},set:function(e){_[t]=e}})},F=c(_),O=0;while(F.length>O)j(F[O++]);x.constructor=C,C.prototype=x,d(r,"RegExp",C)}h("RegExp")},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var s=i("1d80"),r=i("5899"),n="["+r+"]",o=RegExp("^"+n+n+"*"),a=RegExp(n+n+"*$"),c=function(t){return function(e){var i=String(s(e));return 1&t&&(i=i.replace(o,"")),2&t&&(i=i.replace(a,"")),i}};t.exports={start:c(1),end:c(2),trim:c(3)}},"5b19":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-1 p-2 theme-dark relative"},[i("div",{staticClass:"flex w-full items-center flex-row justify-start text-lg"},[i("button",{staticClass:"text-lg py-2",on:{click:function(e){t.edit=!1,t.loopEditor=!1,t.categories=!1}}},[t._v("Products")]),t.edit?t._e():i("button",{staticClass:"text-lg py-2",on:{click:function(e){t.categories=!t.categories}}},[t._v("Categories")]),t.edit?t._e():i("button",{staticClass:"text-lg py-2",on:{click:function(e){return t.productCreate()}}},[t._v("Create ")]),t.edit&&t.editor.current?i("button",{staticClass:"text-lg py-2",on:{click:function(e){return t.productSave()}}},[t._v("» "+t._s(t.editor.current.name))]):t._e(),t.edit?t._e():i("button",{staticClass:"text-lg py-2",on:{click:function(e){t.importFile=!t.importFile}}},[t._v("Import")]),t.edit?t._e():i("button",{staticClass:"text-lg py-2",on:{click:function(e){t.exportFile=!t.exportFile}}},[t._v("Export")]),t.edit?t._e():i("button",{staticClass:"text-lg py-2",class:t.loopEditor?"bg-white text-black":"",on:{click:function(e){t.loopEditor=!t.loopEditor}}},[t._v("Loop Editor")]),t.edit?t._e():i("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"bg-transparent text-lg ml-2",attrs:{type:"text",placeholder:"search"},domProps:{value:t.search},on:{keydown:function(e){return t.productSearch(e)},input:function(e){e.target.composing||(t.search=e.target.value)}}})]),t.edit||t.loopEditor||!t.products||t.categories?t._e():i("div",{staticClass:"flex flex-col bg-gray-100  text-sm"},[i("div",{class:"w-full bg-gray-900 grid grid-cols-"+t.cols},[t._l(Object.keys(t.schema),(function(e){return[t.schema[e].list?i("div",{staticClass:"capitalize font-bold p-2"},[t._v(" "+t._s(e)+" ")]):t._e()]}))],2),t._l(t.products,(function(e){return[e.name?i("div",{key:e._id,class:"text-black text-lg w-full p-1 border-b border-l border-r cursor-pointer grid grid-cols-"+t.cols,on:{click:function(i){t.editor.current=e,t.edit=!0}}},[t._l(Object.keys(t.schema),(function(s){return[t.schema[s].list?i("div",{key:s},["string"===t.schema[s].type?i("span",[t._v(t._s(e[s]))]):t._e(),"image_uri"===t.schema[s].type?i("div",{staticClass:"w-24"},[e.hasOwnProperty("image")?t._e():i("span",{staticClass:"w-24"}),i("img",{staticClass:"h-24 w-24 object-cover",attrs:{src:t.productImage(e)}})]):t._e(),"array"===t.schema[s].type?i("span",[t._v(" "+t._s(e[s].length?e.field.join(","):"")+" ")]):t._e(),"list"===t.schema[s].type?i("span",[t._v(" "+t._s(t.productFieldList(e[s],t.schema[s].separator))+" ")]):t._e(),"currency"===t.schema[s].type?i("span",[t._v(" "+t._s(e[s]&&parseInt(e[s])?Number(e[s]).toFixed(t.schema[s].precision):"-")+" ")]):t._e(),"select"===t.schema[s].type?i("span",[t._v(" "+t._s(Array.isArray(e[s])?e[s].join(","):e[s])+" ")]):t._e(),"collection"===s?i("span",[t._v(" "+t._s(e.category)+" ")]):t._e()]):t._e()]}))],2):t._e()]})),i("div",{staticClass:"grid grid-cols-3 p-2"},[i("div",[t._v("Total: "+t._s(t.total))]),i("navigation",{attrs:{size:"4xl"},on:{prev:function(e){t.skip>0&&(t.skip=t.skip-t.limit)},next:function(e){t.total-(t.skip+t.limit)>0&&(t.skip=t.skip+t.limit)}}}),i("div",{staticClass:"text-right"},[t._v(" "+t._s(t.skip+1)+" - "+t._s(t.pageTotal)+" ")])],1)],2),t.edit?i("product-edit",{attrs:{id:t.editor.current._id},on:{close:function(e){t.edit=!t.edit}}}):t._e(),t.loopEditor?i("products-loop-editor",{attrs:{plugin:t.plugin}}):t._e(),t.categories?i("products-categories"):t._e(),t.importFile?i("modal",{attrs:{size:"lg",position:"modal",button:"none"},on:{close:function(e){t.importFile=!t.importFile}}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v("Import Products")]),i("moka-products-import",{attrs:{slot:"content"},slot:"content"})],1):t._e(),t.exportFile?i("modal",{attrs:{size:"lg"},on:{close:function(e){t.exportFile=!t.exportFile},click_0:function(e){t.exportFile=!t.exportFile},click_1:t.exportData}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v("Export Products")]),i("moka-products-export",{attrs:{slot:"content"},slot:"content"})],1):t._e()],1)},r=[],n=i("5530"),o=(i("d3b7"),i("3ca3"),i("ddb0"),i("d81d"),i("b64b"),i("ac1f"),i("841c"),i("7db0"),i("a15b"),i("1276"),i("159b"),i("d262")),a=i("aaa1"),c=i("2f62"),l=i("a0aa"),p={name:"MokaProducts",data:function(){return{edit:!1,loopEditor:!1,categories:!1,importFile:!1,exportFile:!1,products:null,current:null,limit:10,skip:0,search:"",cols:0,images:!1,total:0,plugin:null}},components:{MokaProductsImport:o["default"],MokaProductsExport:a["default"],"product-edit":function(){return i.e("chunk-2d0be299").then(i.bind(null,"2ea1"))},"products-categories":function(){return i.e("nuxpresso_64").then(i.bind(null,"8d28"))},"products-loop-editor":function(){return i.e("chunk-2d0c51c2").then(i.bind(null,"3e60"))}},computed:Object(n["a"])(Object(n["a"])({},Object(c["b"])(["datastore","editor"])),{},{schema:function(){var t=this,e=l["default"];return this.plugin=this.$mapState().desktop.tabs[this.$mapState().desktop.currentTab].plugin,Object.keys(e).map((function(i){e[i].list&&t.cols++})),e},pageTotal:function(){return this.skip+this.limit>this.total?this.total:this.skip+this.limit}}),watch:{skip:function(t){this.search?this.qrySearch():this.qry()}},methods:{qry:function(){var t=this;this.$api.service("products").find({query:{$limit:this.limit,$skip:this.skip,type:"product"}}).then((function(e){t.products=e.data,t.total=e.total,t.products.map((function(t){!t.hasOwnProperty("image")&&(t.image=null)}))}))},qrySearch:function(){var t=this;this.$api.service("products").find({query:{$limit:this.limit,$skip:this.skip,$search:this.search}}).then((function(e){t.products=e.data,t.total=e.total}))},importData:function(){},exportData:function(){},productImage:function(t){return Array.isArray(t.assets)?this.$imageURL(t.assets[0]):this.$imageURL(t.assets)},productFieldList:function(t,e){return t.split(e).join("-").replaceAll("category:","")},productSave:function(){var t=this;this.$api.service("products").patch(this.editor.current._id,this.editor.current).then((function(e){t.$message("Product data saved"),t.editor.current=null,t.edit=!1}))},productCreate:function(){var t=this,e=Object.keys(this.schema),i={};e.forEach((function(t){i[t]=null})),i.name="New product",i.assets=[],i.facets=[],i.type="product",delete i._id,this.$api.service("products").create(i).then((function(e){t.products.unshift(e)}))},productSearch:function(t){13===t.keyCode&&(t.target.value.length>2?(this.skip=0,this.qrySearch()):this.qry())}},mounted:function(){this.qry()}},u=p,d=i("2877"),f=Object(d["a"])(u,s,r,!1,null,null,null);e["default"]=f.exports},"841c":function(t,e,i){"use strict";var s=i("d784"),r=i("825a"),n=i("1d80"),o=i("129f"),a=i("14c3");s("search",1,(function(t,e,i){return[function(e){var i=n(this),s=void 0==e?void 0:e[t];return void 0!==s?s.call(e,i):new RegExp(e)[t](String(i))},function(t){var s=i(e,t,this);if(s.done)return s.value;var n=r(t),c=String(this),l=n.lastIndex;o(l,0)||(n.lastIndex=0);var p=a(n,c);return o(n.lastIndex,l)||(n.lastIndex=l),null===p?-1:p.index}]}))},a0aa:function(t,e,i){"use strict";i.r(e);var s={_id:{type:"id",edit:!1,list:!1},name:{type:"string",edit:!0,list:!0},slug:{type:"string",edit:!0,list:!1},description:{type:"text",edit:!0,list:!1},assets:{type:"image_uri",edit:!0,list:!0},category:{type:"select",edit:!0,list:!0},facets:{type:"select",separator:"|",edit:!0,list:!0},optionGroups:{type:"array",edit:!1,list:!1},optionValues:{type:"list",separator:"|",edit:!1,list:!1},sku:{type:"string",list:!0,edit:!1},parent:{type:"string",list:!1,edit:!1},price:{type:"currency",edit:!1,list:!0},taxCategory:{type:"string",edit:!0,list:!1},stockOnHand:{type:"number",edit:!1,list:!1},trackInventory:{type:"boolean",edit:!1,list:!1},variantAssets:{type:"array",edit:!1,list:!1},type:{type:"array",edit:!1,list:!1},image:{type:"image",edit:!1,list:!1}};e["default"]=s},aaa1:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flex flex-col p-4"},[i("div",{staticClass:"text-sm"},[i("button",{on:{click:function(e){t.resetFields(),t.json=null}}},[t._v("Reset")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.snipcart,expression:"snipcart"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.snipcart)?t._i(t.snipcart,null)>-1:t.snipcart},on:{change:function(e){var i=t.snipcart,s=e.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=t._i(i,n);s.checked?o<0&&(t.snipcart=i.concat([n])):o>-1&&(t.snipcart=i.slice(0,o).concat(i.slice(o+1)))}else t.snipcart=r}}}),t._v(" "),i("label",[t._v("Export to Snipcart")])]),t.schema?i("div",{staticClass:"grid"},[t._m(0),t._l(t.schema,(function(e,s){return[i("div",{staticClass:"grid grid-cols-2"},[i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.mapping[e],expression:"mapping[field]"}],staticClass:"w-3/4",attrs:{type:"text"},domProps:{value:t.mapping[e]},on:{input:function(i){i.target.composing||t.$set(t.mapping,e,i.target.value)}}}),i("i",{staticClass:"material-icons",on:{click:function(e){return t.disableField(s)}}},[t._v("close")])]),i("div",[t.products[0].hasOwnProperty(e)?i("span",[t._v(t._s(e)+" ")]):i("span",[t.snipcart?i("input",{directives:[{name:"model",rawName:"v-model",value:t.snipcartUrl,expression:"snipcartUrl"}],attrs:{type:"text"},domProps:{value:t.snipcartUrl},on:{input:function(e){e.target.composing||(t.snipcartUrl=e.target.value)}}}):i("input",{directives:[{name:"model",rawName:"v-model",value:t.mapping[e],expression:"mapping[field]"}],attrs:{type:"text"},domProps:{value:t.mapping[e]},on:{input:function(i){i.target.composing||t.$set(t.mapping,e,i.target.value)}}})])])])]})),i("button",{on:{click:function(e){return t.createJson()}}},[t._v("Export")])],2):t._e(),t.schema&&t.json?i("div",[i("div",{staticClass:"flex flex-col p-2"},[i("p",[t._v("You exporting "+t._s(t.products.length)+" products "),i("br")]),i("vue-blob-json-csv",{attrs:{"file-type":"json","file-name":"products",data:t.json}},[i("button",{staticClass:"my-2 success"},[t._v("Download Products")]),t._v(" Products: "+t._s(t.products.length)+" ")])],1)]):t._e()])},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid grid-cols-2"},[i("label",[t._v("Export As")]),i("label",[t._v("Product Field")])])}],n=(i("a434"),i("b64b"),i("159b"),i("ac1f"),i("1276"),i("d81d"),i("caad"),i("2532"),{name:"MokaProductsExport",data:function(){return{files:[],schema:null,mapping:{},json:null,importOK:[],importError:[],products:null,snipcart:!1,prefix:"",snipcartUrl:"/product/$"}},computed:{},watch:{snipcart:function(t){t?(this.prefix="data-item-",this.schema.push("url"),this.mapping["url"]="",this.createMapping()):(this.prefix="",this.schema.splice(this.schema.indexOf("url"),1),delete this.mapping.url)}},mounted:function(){var t=this;this.$http.get("products").then((function(e){t.products=e.data;var i=t.products?Object.keys(t.products[0]):[];i.forEach((function(e){t.mapping[e]=t.prefix+e})),t.schema=i}))},methods:{resetFields:function(){var t=this,e=this.products?Object.keys(this.products[0]):[];e.forEach((function(e){t.mapping[e]=t.prefix+e})),this.schema=e},createMapping:function(){var t=this;this.schema.forEach((function(e){t.mapping[e]=t.prefix+e}))},disableField:function(t){this.schema.splice(t,1),this.createMapping()},setImport:function(t,e){this.mapping[t]=e},createJson:function(){var t=this;if(this.products){var e=[];this.products.forEach((function(i){var s={};t.schema.forEach((function(e){if("url"===e&&t.snipcart){var r=t.snipcartUrl.split("$");s[t.mapping[e]]=r[0]+i[r[1]]}else s[t.mapping[e]]=i[e]})),e.push(s)})),console.log(e),this.json=e}},exportProducts:function(){var t=this;this.importing=!0,this.importOK=[],this.importError=[],this.json.map((function(e){var i={};Object.keys(t.mapping).map((function(s){if(s.includes("$")){var r=t.mapping[s].split("$");r=r[0];var n=r[1];i[s]=r+e[n]}else i[s]=e[t.mapping[s]]}))}))}}}),o=n,a=i("2877"),c=Object(a["a"])(o,s,r,!1,null,null,null);e["default"]=c.exports},c8d2:function(t,e,i){var s=i("d039"),r=i("5899"),n="​᠎";t.exports=function(t){return s((function(){return!!r[t]()||n[t]()!=n||r[t].name!==t}))}},d262:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flex flex-col p-4 bg-white text-black"},[t.schema&&t.importFields?i("div",[i("div",{staticClass:"flex flex-col p-2"},[i("p",[t._v("You are importing "+t._s(t.json.length)+" products "),i("br")]),t.importing?t._e():i("button",{staticClass:"warning",on:{click:t.importProducts}},[t._v("Import Products")]),t.importOK?i("div",[t._v(" Imported: "+t._s(t.importOK.length)+" Errors: "+t._s(t.importError.length)+" "),t._l(t.importError,(function(e){return i("div",{staticClass:"flex flex-col"},[i("div",[t._v(t._s(e))])])}))],2):t._e()])]):t._e(),i("div",{staticClass:"flex text-white relative text-center p-2"},[i("input",{staticClass:"absolute top-0 left-0 right-0 bottom-0 ",attrs:{type:"file"},on:{change:t.loadTextFromFile}}),i("button",{staticClass:"w-full warning"},[t._v("Select File")])])])},r=[],n=(i("b64b"),i("d81d"),i("b0c0"),i("1e25"),i("4d63"),i("ac1f"),i("25f0"),i("5319"),i("a0aa")),o=(i("52cd"),{name:"MokaProductsImport",data:function(){return{files:[],json:null,loaded:!1,loadedComponent:"",blockIndex:null,schema:null,toImport:null,importFields:null,mapping:{},importOK:[],importError:[]}},watch:{json:function(t){t.length&&(this.importFields=Object.keys(t[0]))}},mounted:function(){this.schema=n["default"]},methods:{setImport:function(t,e){this.mapping[t]=e},loadTextFromFile:function(t){var e=this;this.importing=!1;var i=t.target.files[0],s=new FileReader,r=this;s.onload=function(t){e.json=r.csv_to_json(t.target.result)},s.readAsText(i)},importProducts:function(){var t=this;this.importing=!0,this.importOK=[],this.importError=[],this.json.map((function(e){e.name?e.type="product":e.type="variation",e.assets&&(e.assets="/uploads/"+e.assets),t.$api.service("products").create(e).then((function(i){t.importOK.push(e.sku)})).catch((function(e){t.importError.push(produc.sku)}))}))},csv_to_json:function(t){for(var e=this.CSVToArray(t),i=[],s=1;s<e.length;s++){i[s-1]={};for(var r=0;r<e[0].length&&r<e[s].length;r++){var n=e[0][r].trimEnd();i[s-1][n]=e[s][r].trimEnd().replaceAll("category:","")}}return console.log(i),i},CSVToArray:function(t,e){e=e||",";var i=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),s=[[]],r=null;while(r=i.exec(t)){var n=r[1];if(n.length&&n!=e&&s.push([]),r[2])n=r[2].replace(new RegExp('""',"g"),'"');else n=r[3];s[s.length-1].push(n)}return s}}}),a=o,c=i("2877"),l=Object(c["a"])(a,s,r,!1,null,null,null);e["default"]=l.exports}}]);