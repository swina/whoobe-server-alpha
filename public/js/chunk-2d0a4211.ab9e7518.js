(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4211"],{"04b9":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.hasblocks?n("div",{class:"editor-container min-h-screen top-0 right-0 left-0 bottom-0 flex flex-row"},[n("div",{staticClass:"w-full overflow-y-auto overflow-x-hidden"},[n("div",{class:"relative mt-8 ml-4 mr-4 cursor-pointer"},[e.disable?n("div",{class:"main absolute top-0 left-0 bottom-0 right-0 z-max "}):e._e(),n("div",{class:"mt-4 mb-10 "+e.pageCss,style:e.background,attrs:{"data-container-tag":"block component"}},[n("block-selectors",{key:e.doc.id,attrs:{doc:e.doc,component:e.component,parent:e.component,develop:!0,category:e.component.category,root:!0},on:{slidersettings:function(t){e.sliderSettings=!e.sliderSettings},save:e.saveComponent,preview:function(t){e.preview=!e.preview},slider:function(t){e.slider=!e.slider,e.disable=!1},animations:function(t){e.animations=!e.animations},edit:e.editInline,copy:e.copyElement,paste:e.pasteElement,duplicate:e.duplicateElement,saveblock:e.saveBlock,delete:e.removeElement}}),e.doc.id===e.editor.selected?n("block-floating",{staticClass:"z-highest",attrs:{doc:e.doc}}):e._e()],1),n("div",{staticClass:"absolute inset-0 flex flex-row p-1"},[e._l(12,(function(e){return[n("div",{staticClass:"w-1/12 bg-opacity-75",class:"bg-opacity-50 bg-gray-"+100*(e%2+1)})]}))],2)])])]):e._e()])},i=[],s=(n("53ca"),n("1da1")),r=n("5530"),a=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("b0c0"),n("159b"),n("a434"),n("a4d3"),n("e01a"),n("2f62")),c=n("52cd"),l=n.n(c),d={name:"BlockEditor",components:{"block-selectors":function(){return Promise.all([n.e("chunk-4a5f46a6"),n.e("chunk-3ec8a586")]).then(n.bind(null,"a8ac"))},"block-floating":function(){return n.e("chunk-2d21806c").then(n.bind(null,"c8de"))}},data:function(){return{addType:!1,newType:"",disable:!1,addBlock:!1,editContent:!1,sliderSettings:!1,animations:!1,animation:"",breakpoint:"md",fontFamily:"Barlow Condensed",doc:null,current:null,importReusable:!1,reusable:!1,customize:!1,media:!1,settings:!1,preview:!1,slider:!1,grids:!1,grid:{cols:1},mycomponent:null,printScreen:null,exportComponent:!1,saveBlockAsComponent:!1,copiedElement:null,newComponent:{name:"A new component",description:"A new component by MOKA",category:"",enabled:!0,tags:""},snapshot:null,html:null,createPage:!1,page:{title:"new page",categories:[],template_id:"",SEO:{title:"new page",description:"A SEO description "}},bodySettings:!1,templateSettings:!1,disableBodyCss:!0,timer:null,endEditor:!1,jsonToExport:null,docOptions:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(a["b"])(["moka","editor","datastore"])),{},{show:function(){return""},devMode:function(){return!0},body_settings:function(){return this.preview?this.doc.body_bg+" "+this.doc.body_color:"w-full bg-white"},background:function(){if(this.doc.image)return"background-image:url("+this.$imageURL(this.doc.image)+");"},pageCss:function(){if(this.doc){var e=new Date;return e=e.getTime(),this.doc.css}},hasblocks:function(){return this.component=this.$attrs.blocks,this.doc=this.$attrs.blocks.json,!this.doc.id&&(this.doc.id=this.$randomID()),!0},schema:function(){return this.datastore.dataset.elements.moka}}),methods:{maincontext:function(){console.log("main context menu")},addPlugin:function(e){var t={id:this.$randomID(),type:"plugin",name:e.name,plugin:e,element:"div",tag:"plugin",css:"",style:"",icon:"settings_input_component"};this.addReusable(t)},exportJSON:function(){var e=JSON.parse(JSON.stringify(this.component));delete e.id,delete e.autosave;var t=this;e.hasOwnProperty("image")?this.dataURI(t.$imageURL(e.image)).then((function(e){return e})).then((function(n){e.image_uri=n,console.log(e),t.jsonToExport=JSON.stringify(e)})):t.jsonToExport=JSON.stringify(e)},dataURI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e).then((function(e){return e.blob()}));case 2:return n=t.sent,t.next=5,new Promise((function(e){var t=new FileReader;t.onload=function(){return e(t.result)},t.readAsDataURL(n)}));case 5:return o=t.sent,t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})))()},addGrid:function(e){this.editor.current.blocks.push(e),this.grids=!1},saveComponent:function(){this.devMode?(this.editor.current.component=this.doc,this.$store.dispatch("component",this.doc),this.$emit("save")):this.$store.dispatch("message","This option is available only in development mode")},hasPages:function(){return""},saveNewType:function(){this.datastore.dataset.setup[0].types.components.push(this.newType),this.$http.put("elements",this.moka.elements),this.newType="",this.addType=!1},editInline:function(e){this.current=this.moka.current,this.editContent=!0},saveBlock:function(e){this.current=e,this.saveBlockAsComponent=!0},reusableElement:function(e){this.reusable=!0},copyElement:function(e){delete e.parent;var t={};t=JSON.parse(JSON.stringify(this.editor.current)),t=this.$clone(t),t.id=this.$randomID(),window.localStorage.setItem("whoobe-clipboard",JSON.stringify(t)),this.copiedElement=t,this.current=t,this.$store.dispatch("message","Element copied")},removeElement:function(){this.$findNode(this.editor.current.id,this.doc,!0)},pasteElement:function(){var e=JSON.parse(window.localStorage.getItem("whoobe-clipboard"));this.copiedElement=e,this.copiedElement.id=this.$randomID();var t=Object.assign({},this.copiedElement);t.id=this.$randomID(),console.log(t),this.addReusable(t)},duplicateElement:function(e,t){var n,o=e,i=l.a.parent(o.json,'$..blocks[?(@.id=="'+t.id+'")]');if(i){i.forEach((function(e,o){e.id===t.id&&(n=o)}));var s=JSON.parse(JSON.stringify(this.editor.current)),r=this.$clone(s);r.id=this.$randomID(),i.splice(n+1,0,r),this.$message("Element duplicated")}},replaceElement:function(e){e.id=this.$randomID();var t=JSON.parse(JSON.stringify(e));this.editor.current=t,this.editor.parent[0][this.editor.parent[1]]=t,delete t.parent,this.$store.dispatch("selected",t.id),this.$store.dispatch("setCurrent",t),this.$store.dispatch("setAction",null),this.$store.dispatch("setParent",null)},mobile:function(e){return e===this.breakpoint?"nuxpresso-icon-circle":""},createGridNew:function(){var e,t=JSON.parse(JSON.stringify(this.schema.containers[0]));t["blocks"]=[],t.id=this.$randomID(),t.css.container="grid md:grid-rows-1 md:grid-cols-"+this.grid.cols+" grid-cols-1",t.css.css="",t.cols=parseInt(this.grid.cols);for(var n=0;n<parseInt(this.grid.cols);n++){e=JSON.parse(JSON.stringify(this.schema.text[2])),e.id=this.$randomID();var o={id:this.$randomID(),blocks:[e],image:null,css:{css:"flex-col",container:"flex"},style:"",type:"flex",tag:"blocks"};t.blocks[n]=o}this.doc.blocks.push(t),this.grids=!1},addMultipleBlocks:function(e){var t=this;e.json.blocks.forEach((function(e){var n={json:{blocks:[e]}};t.addReusable(n)}))},addObject:function(e){this.reusable=!1;var t,n={};if(e.hasOwnProperty("json")?e.json.hasOwnProperty("slider")?(t=e.json,n=this.$clone(t),console.log("slider => ",n)):(t=e.json.blocks[0],n=this.$clone(t)):(t=e,n=this.$clone(t)),n){n["gsap"]={animation:"",ease:"",duration:0,delay:0},n.id=this.$randomID();var o=this.editor.current;o&&!this.addBlock||(o=this.doc),o.blocks.push(n),this.addBlock=!1,this.$action()}},addReusable:function(e){this.addObject(e)},addComponent:function(e){var t={};t=Object.assign({},e.json),t.id=this.$randomID();var n=this.$getDoc(this.doc,this.current.coords);if("slider"!=e.category){var o=t;"document"===t.tag&&(o=t.blocks[0]),e.hasOwnProperty("blocks")&&(o=this.$unique(t)),n.blocks.push(o)}this.importReusable=!1,this.reusable=!1},save:function(e){e&&(this.mycomponent.image=e,this.mycomponent.image_uri=e),this.$emit("save")},printElement:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=document.querySelector(".moka-block-preview"),n=n.querySelector("#content"),o={type:"dataURL",useCORS:!0,scale:.7},e.next=5,t.$html2canvas(n,o);case 5:t.snapshot=e.sent,t.$store.dispatch("message","Click on the image to download");case 7:case"end":return e.stop()}}),e)})))()},saveBlockAsNewComponent:function(){var e=this.$randomID(),t={blocks_id:e,name:this.newComponent.name,description:this.newComponent.description,category:this.newComponent.category,enabled:!0,json:{blocks:[this.editor.current],css:"",id:e,image:null,tag:"document"},loop:null,loop_limit:null,loop_type:null};return this.saveBlockAsComponent=!1,this.$emit("saveasreusable",t),null},viewhtml:function(e){this.html=this.$beautify(e.replaceAll("\x3c!----\x3e","").replaceAll("[object Object]",""))},checkAutosave:function(){var e=new Date;e=e.getTime();var t=window.localStorage.getItem("moka-save");t?e-t>3e5?this.endEditor=!0:this.$router.push("dashboard"):$router.push("dashboard")},openPreview:function(){window.localStorage.setItem("moka-preview",JSON.stringify(this.doc)),window.localStorage.setItem("moka-settings",JSON.stringify(this.moka.settings));var e=this.$router.resolve({path:"/preview"}),t=window.open(e.href,"moka","width="+window.screen.availWidth);t.focus()}},watch:{preview:function(e){return e?this.$store.dispatch("message","Alt+x to close - Alt+s to save with printscreen"):null},fontFamily:function(e){document.querySelector("#content").style.fontFamily=e,this.doc.fontFamily=e},exportComponent:function(e){if(e)return this.exportJSON()}},mounted:function(){var e=this;0===e.doc.blocks.length&&(this.$store.dispatch("setCurrent",e.doc),this.$store.dispatch("selected",e.doc.id)),this.$store.dispatch("setComponent",this.$attrs.blocks),this.timer=window.setInterval((function(){var t={blocks:e.doc,lastUpdate:new Date},n={autosave:t};console.log("autosave",n)}),3e5)},beforeDestroy:function(){window.clearInterval(this.timer)}},u=d,h=n("2877"),p=Object(h["a"])(u,o,i,!1,null,null,null);t["default"]=p.exports}}]);