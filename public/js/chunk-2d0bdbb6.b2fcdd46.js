(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bdbb6"],{"2cf5":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"w-1/2"},[i("icon",{staticClass:"top-right m-1",attrs:{name:"close"},on:{click:function(t){return e.$emit("close")}}}),i("icon",{staticClass:"top-right m-1 mr-6",attrs:{name:e.theme?"grid_on":"list"}}),i("h3",[e._v("Media Upload")]),i("vue-file-agent",{ref:"vueFileAgent",attrs:{multiple:!0,deletable:!0,theme:e.theme?"list":""},on:{beforedelete:function(t){return e.onBeforeDelete(t)}},model:{value:e.fileRecords,callback:function(t){e.fileRecords=t},expression:"fileRecords"}}),i("button",{attrs:{disabled:!e.fileRecords.length},on:{click:function(t){return e.uploadFiles()}}},[e._v(" Upload "+e._s(e.fileRecords.length)+" files ")]),i("button",{on:{click:function(t){return e.$emit("close")}}},[e._v("Close")])],1)},o=[],l=(i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("06c5"));function r(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Object(l["a"])(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==i["return"]||i["return"]()}finally{if(s)throw r}}}}var a=i("ade3"),s=(i("b0c0"),i("159b"),i("a434"),{name:"MokaMediaUpload",data:function(){var e;return e={selectedFiles:null,currentFile:void 0,progress:0,message:"",fileInfos:[],filename:"",preview:null,uploading:!1,theme:!0,fileRecords:[],fileRecordsForUpload:[]},Object(a["a"])(e,"currentFile",null),Object(a["a"])(e,"imageURL",""),Object(a["a"])(e,"image64",""),e},mounted:function(){var e=this.$api.service("media ");e.on("created",(function(e){return console.log("New image uploaded ",e)}))},computed:{uploadUrl:function(){return"http://localhost:3030/upload"}},methods:{selectFile:function(){this.preview=null,this.previewFile(),this.selectedFiles=this.$refs.file.files},upload:function(){var e=this;this.progress=0,this.currentFile=this.selectedFiles.item(0),console.log(this.currentFile),this.uploadFile(this.currentFile,(function(t){e.uploading=!0,e.message="Uploading ...",e.progress=Math.round(100*t.loaded/t.total)})).then((function(t){e.uploading=!1,e.message=t.data.message,e.currenFile=null,e.selectedFiles=null,e.preview=null,e.filename="",e.$emit("uploaded")})).then((function(t){e.uploading=!1,e.fileInfos=t.data})).catch((function(){e.progress=0,e.message="Could not upload the file!",e.currentFile=void 0})),this.selectedFiles=void 0},previewFile:function(){var e=this,t=this.$refs.file.files[0];if(this.filename=t.name,t&&-1!==t.type.indexOf("image/")){var i=new FileReader;i.onload=function(t){e.preview=t.target.result},i.readAsDataURL(t)}},uploadFiles:function(){var e=this;this.fileRecordsForUpload=this.fileRecords,this.fileRecordsForUpload.forEach((function(t,i){e.uploadFile(t,t.file,(function(t){e.uploading=!0,e.message="Uploading ...",e.progress=Math.round(100*t.loaded/t.total)}),i).then((function(t){e.fileRecordsForUpload.splice(i,1),e.$emit("uploaded")}))})),this.fileRecords=[]},onBeforeDelete:function(e){var t=this.fileRecordsForUpload.indexOf(e);if(-1!==t){this.fileRecordsForUpload.splice(t,1);var i=this.fileRecords.indexOf(e);-1!==i&&this.fileRecords.splice(i,1)}else this.$refs.vueFileAgent.deleteFileRecord(e)},createBase64Image:function(e,t){console.log(e.dimensions.width),t["dimensions"]=e.dimensions;var i=new FileReader;i.readAsBinaryString(t),i.onload=function(){new Promise((function(e){e(i.result)}))}},uploadFile:function(e,t,i,n){var o=new FormData;o.append("file",t);var l,a=r(o.entries());try{for(a.s();!(l=a.n()).done;){var s=l.value;console.log(s[0]+", "+s[1])}}catch(d){a.e(d)}finally{a.f()}return this.createBase64Image(e,t),this.$http.post("upload/file",o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:i})}}}),d=s,c=i("2877"),u=Object(c["a"])(d,n,o,!1,null,null,null);t["default"]=u.exports}}]);